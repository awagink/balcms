GENTICS.Aloha.PastePlugin=new GENTICS.Aloha.Plugin("com.gentics.aloha.plugins.Paste");GENTICS.Aloha.PastePlugin.pasteHandlers=[];
GENTICS.Aloha.PastePlugin.init=function(){var a=this;this.pasteDiv=jQuery('<div style="position:absolute; top:-100000px; left:-100000px"></div>');this.pasteDiv.attr("contentEditable","true");jQuery("body").append(this.pasteDiv);GENTICS.Aloha.EventRegistry.subscribe(GENTICS.Aloha,"editableCreated",function(b,c){jQuery.browser.msie?c.obj.bind("beforepaste",function(){a.redirectPaste()}):c.obj.bind("paste",function(){a.redirectPaste();window.setTimeout(function(){a.getPastedContent()},10)})});jQuery.browser.msie&&
this.pasteDiv.bind("paste",function(){window.setTimeout(function(){a.getPastedContent()},10)})};GENTICS.Aloha.PastePlugin.redirectPaste=function(){this.currentRange=new GENTICS.Utils.RangeObject(true);this.currentEditable=GENTICS.Aloha.activeEditable;this.pasteDiv.text("");this.currentEditable&&this.currentEditable.blur();GENTICS.Utils.Dom.setCursorInto(this.pasteDiv.get(0));this.pasteDiv.focus()};
GENTICS.Aloha.PastePlugin.getPastedContent=function(){for(var a=0;a<this.pasteHandlers.length;++a)this.pasteHandlers[a].handlePaste(this.pasteDiv);if(this.currentRange&&this.currentEditable){var b=this.pasteDiv.contents();for(a=b.length-1;a>=0;--a)GENTICS.Utils.Dom.insertIntoDOM(jQuery(b.get(a)),this.currentRange,this.currentEditable.obj,false);this.currentEditable.activate();this.currentEditable.obj.focus();b.length>0?GENTICS.Utils.Dom.setCursorAfter(b.get(b.length-1)):this.currentRange.select()}this.currentEditable=
this.currentRange=false;this.pasteDiv.text("")};GENTICS.Aloha.PastePlugin.register=function(a){this.pasteHandlers.push(a)};GENTICS.Aloha.PastePlugin.PasteHandler=function(){GENTICS.Aloha.PastePlugin.register(this)};GENTICS.Aloha.PastePlugin.PasteHandler.prototype.handlePaste=function(){};
